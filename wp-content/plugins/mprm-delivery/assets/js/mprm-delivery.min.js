var MprmDelivery=function(t){"use strict";var e;function r(){var e=t("#mprm_purchase_form").find(".mprm-required");e.length&&t.each(e,function(){var e=t(this);e.data("required",e.attr("required")),e.removeAttr("required")})}function a(){if(t('input[name="delivery-mode"]').length){var e=t('input[name="delivery-mode"]:checked');e&&e.length&&e.val()&&"collection"===e.val()&&r(),t(document).on("change",'input[name="delivery-mode"]',function(){var e=t(this).val(),a={};a.delivery_type=e,a.nonce=t('input[name="delivery_checkout_form_nonce"]').val();var n,o={mprde_controller:"delivery",action:"get_delivery_cost",data:a};MP_RM_Registry._get("MP_RM_Functions").wpAjax(o,function(r){t(".mprm_cart_subtotal_amount").each(function(){var e=t(this);e.text(r.subtotal),e.attr("data-subtotal",r.subtotal),e.attr("data-total",r.subtotal)}),t(".mprm_cart_tax_amount").each(function(){t(this).text(r.taxes)}),t(".mprm_cart_amount").each(function(){var e=t(this);e.text(r.total),e.attr("data-subtotal",r.total),e.attr("data-total",r.total)});var a=t(".mprm_cart_delivery_amount");"collection"===e?(a.html(a.data("free")),a.data("cost",r.delivery_cost)):a.html(r.delivery_cost)},function(t){console.warn("Some error!!!"),console.warn(t)}),"collection"===e?r():(n=t("#mprm_purchase_form").find(".mprm-required")).length&&t.each(n,function(){var e=t(this);e.attr("required",e.data("required"))})})}}function n(){if(e)return e;e=this}return n.prototype.init=function(){a()},n.prototype.addCartListener=function(){t(document).ajaxComplete(function(e,r,a){var n=function(t,e){var r,a=[];if(t){for(var n=t.slice(t.indexOf("?")+1).split("&"),o=0;o<n.length;o++)r=n[o].split("="),a.push(r[0]),a[r[0]]=r[1];return void 0!==e?a[e]:a}return!1}(a.data);if(void 0!==n){var o=n.controller;if("update_cart_item_quantity"===n.mprm_action&&"cart"===o)try{var i=t.parseJSON(r.responseText),c=t(".mprm_cart_delivery_amount");"collection"===t('input[name="delivery-mode"]:checked').val()?(c.html(c.data("free")),c.data("cost",i.data.delivery_cost)):c.html(i.data.delivery_cost)}catch(t){console.log(t)}}})},n}(jQuery);!function(t){"use strict";jQuery(document).ready(function(){var t=new MprmDelivery;t.init(),t.addCartListener()})}();